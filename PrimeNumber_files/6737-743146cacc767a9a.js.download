"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6737],{96737:function(e,t,a){a.r(t),a.d(t,{ChatList:function(){return ChatList}});var s=a(95802),n=a(38776),o=a(73022),l=a(41935),i=a(81936),r=a(10733),c=a(55197),d=a(14104),g=a(60110);function ChatMessageActions(e){let{message:t,editing:a,onEdit:n,className:o,...l}=e,{isCopied:r,copyToClipboard:c}=(0,g.m)({timeout:2e3});return(0,s.jsx)("div",{className:(0,i.cn)("flex items-center justify-end transition-opacity group-hover:opacity-100 md:absolute md:-right-10 md:-top-2 md:opacity-0",o),...l})}var u=a(82038),p=a(13988),m=a(91570),h=a(61501),f=a(31561),x=a(77135);let getHostName=e=>{try{let t=new URL(e),a=t.hostname;return a.startsWith("www.")&&(a=a.slice(4)),a.split(".").slice(0,a.split(".").length-1).join(".")}catch(t){return e}},SourceCards=e=>{let{sources:t}=e,[a,n]=(0,u.useState)(!1);(0,u.useEffect)(()=>{window.matchMedia("(max-width: 768px)").matches&&n(!0)},[]);let o=Array.from(new Set(t.map(e=>e.link))).map(e=>t.find(t=>t.link===e));return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{className:"mx-auto sm:max-w-2xl sm:px-0",children:(0,s.jsx)("div",{className:"mb-4 grid grid-cols-2 sm:grid-cols-4 gap-2 px-0 sm:px-0",children:o.slice(0,4).map((e,t)=>(0,s.jsxs)("div",{className:"cursor-pointer  rounded-md border p-4 ".concat(t>3&&"hidden md:block"),style:{position:"relative",padding:"6px 8px 2em"},onClick:async()=>{window.open(e.link)},children:[(0,s.jsxs)("div",{className:"text-sm font-semibold overflow-hidden text-wrap ellipsis-2 sources-card-line ",children:["  ",(0,s.jsx)("p",{style:{fontSize:".75rem"},children:e.title})]}),(0,s.jsxs)("div",{className:"text-sm text-zinc-600 flex items-center mt-1 ",style:{position:"absolute",bottom:"0.5em"},children:[(0,s.jsx)(x.qE,{className:"h-4 w-4 cursor-pointer mr-1",children:(0,s.jsx)(x.F$,{src:"https://t3.gstatic.com/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=".concat(e.link)})}),(0,s.jsx)("div",{className:"text-sm overflow-hidden text-wrap ellipsis-1",style:{color:"#767676",fontSize:".75rem"},children:getHostName(e.link)})]})]},e.link))})})})};function ChatMessage(e){var t,a,n,g;let{message:x,append:v,setMessages:b,setShowSpinner:j,messageType:y,botImage:w,fileUploaded:N,setFileUploaded:k,addHeighLighter:C,setSearchResults:S,updateMessage:E,cacheChatToLocalStorage:z,index:T,...F}=e,[L,R]=(0,u.useState)(!1),[_,A]=(0,u.useState)(x.content),I=(0,u.useRef)(null),[M,O]=(0,u.useState)(!1),[B,$]=(0,u.useState)([]),[H,q]=(0,f._)("version",null);(0,u.useEffect)(()=>{let e="$~~~$";if(x.content.includes(e)&&"assistant"===x.role)try{let t=JSON.parse(x.content.split(e)[1]);$(t),S(t);let a=x.content.split(e)[2];A(a)}catch(t){console.log(t),3===x.content.split(e).length?A(x.content.split(e)[2]):A(x.content)}else A(x.content)},[x.content]);let onEdit=()=>{R(!L),L&&E(T,_)},[U,V]=(0,u.useState)(""),W=(0,u.useRef)(null);if((0,u.useEffect)(()=>{W.current&&U&&(W.current.src=U)},[U]),x){let e=x.content.includes("$@$"),t=x.content.startsWith("$@$"),s=x.content.split("$@$").length>=3,o=null;if(e&&t&&s&&(o=x.content.split("$@$")[1],x.content=x.content.split("$@$")[2],M||(O(!0),q(o))),x.content.includes("FILE:BB")||x.content.includes("FILE:BB")){let[e,t,...s]=x.content.split("\n$#$\n");x.data&&(null===(a=x.data)||void 0===a?void 0:a.imageBase64)&&(null===(n=x.data)||void 0===n?void 0:n.imageBase64.startsWith("data:image"))&&V(null===(g=x.data)||void 0===g?void 0:g.imageBase64),x.content=s.join("")}}let speakIt=async(e,t)=>{let a=e.getAttribute("isplaying");if(a){let t=document.getElementById(a);null==t||t.pause(),null==t||t.remove(),e.setAttribute("isplaying","")}else{t=t.toString();let a=(0,m.x0)(),s=await (0,p.jQ)(t),n=document.createElement("audio");n.src=s,n.id=a,n.style.display="none",n.play(),e.setAttribute("isplaying",a),e.append(n)}},D=[];return N&&(D=N.filter(e=>e.index===T)),(0,s.jsxs)("div",{onClick:e=>{C(e)},className:(0,i.cn)("group relative mb-4 flex items-start md:-ml-12","user"===x.role?"user-message":""),...F,children:[(0,s.jsx)("div",{className:(0,i.cn)("flex h-8 w-8 shrink-0 select-none items-center justify-center rounded-md border shadow message-role-icon","user"===x.role?"bg-background":"bg-transparent text-primary-foreground"),children:"user"===x.role?(0,s.jsx)(d.f7,{}):w?(0,s.jsx)("img",{src:w,className:"behavior-avatar object-cover",style:{margin:"auto",borderRadius:"calc(var(--radius) - 2px)"}}):(0,s.jsx)(d.No,{})}),(0,s.jsxs)("div",{className:"ml-4 flex-1 space-y-2 overflow-hidden px-1",children:["assistant"===x.role&&(0,s.jsx)("div",{className:"response-speaker",style:{float:"right",display:"none"},onClick:e=>speakIt(e.target,x.content),children:(0,s.jsx)(h.z,{variant:"outline",children:(0,s.jsx)(d.DY,{})})}),!(null==W?void 0:null===(t=W.current)||void 0===t?void 0:t.src.includes("data:text/"))&&(0,s.jsx)("img",{ref:W,className:"h-100"}),"spinner"===y?(0,s.jsx)("div",{role:"status",style:{marginTop:0,display:"flex"},children:(0,s.jsx)(d.c0,{})}):(0,s.jsxs)(s.Fragment,{children:[D.length>0&&"user"===x.role&&(0,s.jsx)(s.Fragment,{children:D[0].file.startsWith("data:video")&&(0,s.jsx)("video",{controls:!0,children:(0,s.jsx)("source",{src:D[0].file})})}),(0,s.jsx)(SourceCards,{sources:B}),L?(0,s.jsx)("textarea",{autoFocus:!0,ref:I,value:_,style:{background:"transparent",borderColor:"none",width:"100%",resize:"none",height:"fit-content",outline:"none"},rows:_.includes("\n")?_.split("\n").length:_.length>80?Math.round(_.length/80):1,onChange:e=>{A(e.target.value)},onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||onEdit()}}):(0,s.jsx)(c.s,{className:"prose break-words dark:prose-invert prose-p:leading-relaxed prose-pre:p-0 fix-max-with-100",remarkPlugins:[o.Z,l.Z],components:{p(e){let{children:t}=e;return(0,s.jsx)("p",{className:"mb-2 last:mb-0",children:t})},code(e){let{node:t,className:a,children:n,...o}=e;if(n&&n.constructor===Array&&Object.values(n).length&&"▍"==n[0])return(0,s.jsx)("span",{className:"mt-1 animate-pulse cursor-default",children:"▍"});let l=/language-(\w+)/.exec(a||"");return(null==t?void 0:t.children)&&(null==t?void 0:t.children[0])!=null&&!l&&(null==t?void 0:t.children[0]).position?(0,s.jsx)("code",{className:a,...o,children:n}):(0,s.jsx)(r.dn,{cacheChatToLocalStorage:z,language:l&&l[1]||"",value:String(n).replace(/\n$/,""),...o},Math.random())}},children:_})]}),(0,s.jsx)(ChatMessageActions,{message:x,editing:L,onEdit:onEdit})]})]})}var v=a(235),b=a(90077),j=a(34704);function ContinueButton(e){let{className:t,messages:a,onClick:n,id:o,isLoading:l,continueLoading:i,setContinueLoading:r,...c}=e,[d,g]=(0,u.useTransition)(),[p]=(0,f._)("userId",null),childEl=function(e){return async function(){let e=a.at(-1);if(!e||!e.content)return;r(!0),(0,j.X)("Other Engagement","",{tag:"continue"});let t=await fetch("/api/chat/",{method:"POST",body:JSON.stringify({messages:a,id:o,mode:"continue",userId:p,agentMode:{},trendingAgentMode:{}})}).catch(e=>{throw e});if(!t.ok)throw Error(await t.text()||"Failed to fetch the chat response.");if(!t.body)throw Error("The response body is empty.");let s=t.body.getReader();for(localStorage.setItem("forceStop","0");;){let{value:t}=await s.read();if(g(()=>{r(!1)}),"1"==localStorage.getItem("forceStop")||void 0===t)break;let a=new TextDecoder("utf-8"),o=a.decode(t);e.content=e.content+o,n(e.content)}}};return childEl.canceled=l,(0,s.jsx)(u.Fragment,{children:a.length&&a.length%2==0&&(0,s.jsxs)("div",{onClick:childEl(l),className:"text-sm flex items-center justify-center cursor-pointer",children:["Continue",(0,s.jsx)(b.yr4,{className:"ml-2"})]})})}function FeedbackButtons(e){let{className:t,messages:a,message:n,userInput:o,messageWithFeedback:l,reload:i,index:r,setShowSpinner:c,setClickedAnswer2:g,setClickedAnswer3:p,setOpenSidePanel:m,setSelectionText:x,getCheckedResults:y,setIsLoadingApi:w,handleContinue:N,id:k,isLoading:C,continueLoading:S,setContinueLoading:E,setClickedForceWebSearch:z,setMessagesWithFeedback:T,...F}=e,[L]=(0,f._)("userId",null),[R,_]=(0,u.useState)(""),[A,I]=(0,u.useState)(!0),[M,O]=(0,f._)("version",null),handleClick=async e=>{let t="1"===e?"good":"bad";T({type:t}),_(t),await fetch("/api/feedbackChatResult",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({feedback:e,message:n,userInput:o,messageWithFeedback:l,messages:a,version:M})})};return(0,s.jsx)(s.Fragment,{children:A&&(0,s.jsx)("div",{className:"flex justify-start ml-4 w-full font-sans",children:(0,s.jsx)("div",{className:"flex w-5/7 items-center justify-between rounded-lg border-slate-600",children:(0,s.jsxs)("div",{className:"flex items-center space-x-1 py-12",children:[(0,s.jsxs)("div",{className:"flex justify-center",children:[(0,s.jsx)(h.z,{variant:"ghost",size:"icon",className:"text-xs focus-visible:ring-1 focus-visible:ring-slate-700 focus-visible:ring-offset-0",onClick:()=>handleClick("1"),children:"good"===R?(0,s.jsx)(d.pX,{}):(0,s.jsx)(d.hN,{})}),(0,s.jsx)(h.z,{variant:"ghost",className:"focus-visible:ring-1 focus-visible:ring-slate-700 focus-visible:ring-offset-0",onClick:()=>{handleClick("-1")},size:"icon",children:"bad"===R?(0,s.jsx)(d.Ug,{}):(0,s.jsx)(d.yb,{})}),(0,s.jsxs)(v.u,{children:[(0,s.jsx)(v.aJ,{asChild:!0,children:(0,s.jsx)(h.z,{variant:"ghost",size:"icon",className:"focus-visible:ring-1 focus-visible:ring-slate-700 focus-visible:ring-offset-0",onClick:()=>{i(),c(!0),(0,j.X)("Other Engagement","",{tag:"clicked-regenerate"})},children:(0,s.jsx)(d.tr,{})})}),(0,s.jsx)(v._v,{children:"Regenerate"})]})]}),(0,s.jsxs)(v.u,{children:[(0,s.jsx)(v.aJ,{asChild:!0,children:(0,s.jsxs)("div",{onClick:()=>{z(!0),setTimeout(()=>{c(!0),i()},100),(0,j.X)("Other Engagement","",{tag:"force-websearch"})},className:"text-sm flex items-center justify-center cursor-pointer",children:["Answer with Web Search",(0,s.jsx)(b.XCv,{className:"ml-2"})]})}),(0,s.jsx)(v._v,{children:"Regenerate with Web Search"})]}),(0,s.jsx)(ContinueButton,{messages:a,onClick:N,id:k,isLoading:C||S,continueLoading:S,setContinueLoading:E})]})})})})}var y=a(63069),w=a(96163),N=a(89037),k=a(19673),C=a(84254);let S=k.fC,E=u.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(k.ck,{ref:t,className:(0,i.cn)("border-b",a),...n})});E.displayName="AccordionItem";let z=u.forwardRef((e,t)=>{let{className:a,children:n,...o}=e;return(0,s.jsx)(k.h4,{className:"flex",children:(0,s.jsxs)(k.xz,{ref:t,className:(0,i.cn)("flex flex-1 text-left items-center justify-between py-4 font-medium transition-all [&[data-state=open]>svg]:rotate-180",a),...o,children:[n,(0,s.jsx)(C.Z,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})})});z.displayName=k.xz.displayName;let T=u.forwardRef((e,t)=>{let{className:a,children:n,...o}=e;return(0,s.jsx)(k.VY,{ref:t,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...o,children:(0,s.jsx)("div",{className:(0,i.cn)("pb-4 pt-0",a),children:n})})});T.displayName=k.VY.displayName;let F={desktop:70,mobile:45};function Recommendations(e){let{append:t,messages:a,setShowSpinner:n,arrayofRecommendataions:o}=e,scrollToLastMessage=()=>{setTimeout(()=>{let e=document.querySelectorAll(".user-message");e&&e.length>0&&e[e.length-1].scrollIntoView({block:"start",behavior:"smooth"})},10)};function handleClickFollowUp(e){t({id:"123",content:e,role:"user"}),n(!0),scrollToLastMessage()}return(0,s.jsxs)("div",{className:"px-5 max-w-3xl mx-auto",children:[o.length>0&&(0,s.jsx)("h1",{style:{},className:"mb-2 text-lg font-semibold",children:"People Also Ask"}),(0,s.jsx)(S,{type:"single",collapsible:!0,className:"w-full",children:o.map((e,t)=>(0,s.jsx)(E,{value:"item-1",children:(0,s.jsxs)(z,{className:"font-normal",onClick:()=>{handleClickFollowUp(e),(0,j.X)("Other Engagement","",{tag:"clicked-recommendation"})},children:[window.matchMedia("(max-width: 768px)").matches?e.slice(0,F.mobile):e.slice(0,F.desktop),e.length>(window.matchMedia("(max-width: 768px)").matches?F.mobile:F.desktop)?"...":""]})}))})]})}var L=a(95849),R=a(4194),_=a(62194),A=a(29206);function ChatList(e){let{messages:t,append:a,setMessages:o,setShowSpinner:l,showSprinner:i,isLoading:r,fileUploaded:c,id:g,userId:p,setFileUploaded:m,reload:f,setClickedAnswer2:v,setClickedAnswer3:k,arrayofRecommendataions:C,setSelectionText:S,getCheckedResults:E,setIsLoadingApi:z,setOpenSidePanel:T,openSidePanel:F,selectionText:I,isLoadingApi:M,checkedResults:O,setSearchResults:B,handleContinue:$,continueLoading:H,setContinueLoading:q,setClickedForceWebSearch:U}=e,[V,W]=(0,u.useState)([]),[D,P]=(0,u.useState)([]),X=(0,u.useRef)(null);function handleEditorDidMount(e,t){X.current=e}function addCodeBlock(e){P(t=>{let a=[...t,e];return a})}let[,Y]=(0,u.useReducer)(e=>e+1,0),updateMessage=(e,a)=>{let s=t.map((t,s)=>{if(e===s){let e="$~~~$",s=t.content.split(e)[1],n=a;s&&(n="".concat(e).concat(s).concat(e).concat(a));let o={...t,content:n};return o}return t});o(s)};function displayDiff(){let e=t.slice(-1)[0].content.split("```")[1],a="javascript";!1===e.startsWith("\n")&&(a=e.split("\n")[0],e=e.split("\n").slice(1,e.split("\n").length).join("\n"));let s=t.slice(-2,-1)[0].content.split("```")[1],n="javascript";!1===s.startsWith("\n")&&(n=s.split("\n")[0],s=s.split("\n").slice(1,s.split("\n").length).join("\n")),addCodeBlock({code:s,language:n}),addCodeBlock({code:e,language:a}),(0,j.X)("Other Engagement","",{tag:"diff",position:"center"})}if(!t.length)return null;let[J,Z]=(0,u.useState)(""),[K,Q]=(0,u.useState)(!1),applyBot=async()=>{let e=window.location.href;if(e.includes("/agent/")){let t=await (0,y.y)(e.split("agent/")[1]);t&&t.cover.startsWith("data:image")&&Z(t.cover)}else if(e.includes("chat/expert")){let t=e.split("chat/expert-")[1],a=(0,w.H)(t);a&&Z(a)}};(0,u.useEffect)(()=>{applyBot(),window.matchMedia("(max-width: 768px)").matches&&Q(!0)},[]),(0,u.useEffect)(()=>{var e;null===(e=document.querySelector(".blackbox-chat-area"))||void 0===e||e.addEventListener("scroll",e=>{document.querySelectorAll(".blackbox-selection").forEach(e=>e.remove())})},[]);let addHeighLighter=e=>{document.querySelectorAll(".blackbox-selection").forEach(e=>e.remove());var t=null===(n=window.getSelection())||void 0===n?void 0:n.getRangeAt(0),a=window.getSelection(),s=null==a?void 0:a.toString();if(s&&t&&s){var n,o,l=document.createElement("button");l.className="blackbox-selection z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",l.setAttribute("tabindex","-1"),l.innerHTML="Search";let e=t.getClientRects(),a=null;a=e.length>4?e[4]:e[0],l.style.top="".concat(a.top-30,"px"),l.style.left="".concat(a.left,"px"),null===(o=document.querySelector("body"))||void 0===o||o.appendChild(l),l.addEventListener("click",()=>{S(null!=s?s:""),z(!0),setTimeout(()=>{z(!1)},3e3),T(!0),(0,j.X)("check-results","",{status:"clicked-search"}),E(s),document.querySelectorAll(".blackbox-selection").forEach(e=>e.remove())})}},cacheChatToLocalStorage=()=>{localStorage.setItem("cache_temp_chat",JSON.stringify(t))};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(L.yo,{open:F,onOpenChange:e=>T(e),children:(0,s.jsx)(L.ue,{style:{overflow:"auto"},children:(0,s.jsxs)(L.Tu,{children:[(0,s.jsx)(L.bC,{children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(A.Z,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),(0,s.jsx)(_.I,{type:"text",placeholder:"Search...",value:I,onKeyUp:e=>{"Enter"==e.key&&(z(!0),E(I))},onChange:e=>{S(e.target.value)},style:{borderColor:"none"},className:"w-full bg-transparent topic-search-box mt-5 pl-8"})]})}),(0,s.jsx)(L.Ei,{children:M?(0,s.jsx)(d.c0,{}):(0,s.jsx)("div",{children:O&&O.length>0?(0,s.jsx)(s.Fragment,{children:O.map(e=>(0,s.jsxs)("div",{className:"pb-8",children:[(0,s.jsxs)("h1",{className:"text-lg font-semibold cursor-pointer hover:underline",onClick:()=>{(0,j.X)("check-results","",{status:"clicked-result"}),window.open(null==e?void 0:e.link)},children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsxs)(x.qE,{className:"h-3 w-3 cursor-pointer",children:[(0,s.jsx)(x.F$,{src:"https://t3.gstatic.com/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=".concat(null==e?void 0:e.link)}),(0,s.jsx)(x.Q5,{children:"www"})]}),(0,s.jsx)(R._,{className:"leading-normal ml-2 cursor-pointer",children:new URL(null==e?void 0:e.link).origin.split("https://")[1]})]}),null==e?void 0:e.title.split(" ").map((e,t)=>{let a=RegExp("\\b(".concat(I,")\\b"),"i");return e.match(a)&&e.length>0&&I.length>3?(0,s.jsx)("span",{className:"bg-blue-500 text-white",children:e+" "},t):(0,s.jsx)("span",{children:e+" "},t)})]}),(0,s.jsx)(R._,{className:"leading-normal",children:null==e?void 0:e.snippet.split(" ").map((e,t)=>{let a=RegExp("\\b(".concat(I,")\\b"),"i");return e.match(a)&&I.length>3?(0,s.jsx)("span",{className:"bg-blue-500 text-white",children:e+" "},t):(0,s.jsx)("span",{children:e+" "},t)})})]}))}):(0,s.jsx)(s.Fragment,{children:"No Results Found"})})})]})})}),t.map((e,i)=>(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"relative mx-auto max-w-2xl ".concat(K?"":"px-4"),style:K?{}:{margin:"auto",maxWidth:"90%"},children:[(0,s.jsx)(ChatMessage,{cacheChatToLocalStorage:cacheChatToLocalStorage,addHeighLighter:addHeighLighter,message:e,messageType:"message",setShowSpinner:l,botImage:J,updateMessage:updateMessage,append:a,setMessages:o,index:i,fileUploaded:c,setFileUploaded:m,setSearchResults:B}),i<t.length-1&&(0,s.jsx)(n.Separator,{className:"my-4 md:my-8"})]},i),(i==t.length-1&&!r||i<t.length-1)&&"user"!=e.role&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Recommendations,{append:a,messages:t,setShowSpinner:l,arrayofRecommendataions:C}),(0,s.jsx)(FeedbackButtons,{index:i,setIsLoadingApi:z,getCheckedResults:E,setSelectionText:S,setOpenSidePanel:T,setShowSpinner:l,reload:f,messages:t,id:g,isLoading:r,handleContinue:$,continueLoading:H,setContinueLoading:q,messageWithFeedback:V.find((e,t)=>t===i),setClickedAnswer2:v,setClickedAnswer3:k,setClickedForceWebSearch:U,setMessagesWithFeedback:e=>{W(t=>{var a;return null!=t&&t.find((e,t)=>t===i)?(null===(a=t.find((e,t)=>t===i))||void 0===a?void 0:a.type)===e.type?t.filter((e,t)=>t!==i):(t[i].type=e.type,[...t]):[...t,{...e,index:i}]})},message:t.at(-1),userInput:t.at(-2)})]})]})),(0,s.jsx)("div",{className:"relative mx-auto max-w-2xl px-4",style:K?{}:{margin:"auto",maxWidth:"90%"},children:i&&(0,s.jsx)(ChatMessage,{cacheChatToLocalStorage:cacheChatToLocalStorage,addHeighLighter:addHeighLighter,message:{id:"spinner",content:"",role:"system"},updateMessage:updateMessage,messageType:"spinner",botImage:J})}),t.length>=2&&3===t.slice(-2,-1)[0].content.split("```").length&&(3===t.slice(-1)[0].content.split("```").length||2==t.slice(-1)[0].content.split("```").length)&&(0,s.jsxs)(h.z,{variant:"outline",style:{marginBottom:"2.5em"},onClick:()=>{D.length>=2?P([]):displayDiff()},className:"bg-background",children:[(0,s.jsx)(b.dNJ,{className:"mr-2"}),D.length>=2?"Hide Diff":"Show Diff"]}),D.length>=2&&(0,s.jsx)(N.SV,{theme:"vs-dark",height:"60vh",language:D.slice(-1)[0].language,original:D.slice(-2,-1)[0].code,modified:D.slice(-1)[0].code,options:{renderSideBySide:!1},onMount:handleEditorDidMount})]})}},55197:function(e,t,a){a.d(t,{s:function(){return o}});var s=a(82038),n=a(15709);let o=(0,s.memo)(n.U,(e,t)=>e.children===t.children&&e.className===t.className)},77135:function(e,t,a){a.d(t,{F$:function(){return r},Q5:function(){return c},qE:function(){return i}});var s=a(95802),n=a(82038),o=a(74565),l=a(81936);let i=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(o.fC,{ref:t,className:(0,l.cn)("relative flex h-20 w-20 shrink-0 overflow-hidden rounded-full",a),...n})});i.displayName=o.fC.displayName;let r=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(o.Ee,{ref:t,className:(0,l.cn)("aspect-square h-full w-full",a),...n})});r.displayName=o.Ee.displayName;let c=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(o.NY,{ref:t,className:(0,l.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...n})});c.displayName=o.NY.displayName},10733:function(e,t,a){a.d(t,{dn:function(){return v}});var s=a(95802),n=a(82038),o=a(64491),l=a(23691),i=a(60110),r=a(14104),c=a(61501),d=a(6059),g=a(34704),u=a(90077),p=a(89549),m=a(54795),h=a(13988),f=a(47171),x=a(91570);async function runCall(e,t){try{var a=new Headers;a.append("Content-Type","application/json");var s=JSON.stringify({code:e,language:t});let n=await fetch("/api/run",{method:"POST",headers:a,body:s,redirect:"follow"});return n=await n.json()}catch(e){return console.log("ERR: ",e),{stdout:null,stderr:null}}}let v=(0,n.memo)(e=>{let{language:t,value:a,removeTop:v,cacheChatToLocalStorage:b}=e,{isCopied:j,copyToClipboard:y}=(0,i.m)({timeout:2e3}),[w,N]=(0,n.useState)(!1),[k,C]=(0,n.useState)(a),S=(0,n.useRef)(null),E=(0,p.e)();function edit(){(0,g.X)("click edit codeblock","",{}),N(!0)}function saveEdit(){N(!1)}function changeEdit(e){C(e.target.value),z&&T(e.target.value)}(0,n.useEffect)(()=>{C(a)},[a]);let[z,T]=(0,n.useState)(""),[F,L]=(0,n.useState)(!1),R=["python","javascript","bash","html"],handlePlayClick=async e=>{let a=await (0,h.Gg)();if(!a||!a.user){f.default.error("Sign in required."),b(),(0,m.zB)("google");return}if(!R.includes(t))return;(0,g.X)("Other Engagement",E,{tag:"play",language:t});let s="";if(R.includes(t)&&"html"!==t){L(!0);let{stdout:e,stderr:a}=await runCall(k,t);s="Output:\n______________\n".concat(e,"\n").concat(a,"\n"),L(!1)}else"html"===t.toLocaleLowerCase()&&(s='\n          <iframe\n            srcdoc="'.concat(k.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").split('"').join("&quot;"),'"\n            style="\n              display: block;\n              border: none;\n              width: 100%;\n              height: 50vh;\n            "\n            sandbox="allow-scripts allow-forms allow-modals allow-same-origin"\n          >\n          </iframe>\n        '));T(s),setTimeout(()=>{var t,a;null==e||null===(a=e.closest("div.codeblock"))||void 0===a||null===(t=a.querySelector("iframe"))||void 0===t||t.scrollIntoView({behavior:"smooth",block:"center"})},300)};return(0,s.jsxs)("div",{className:"relative w-full font-sans codeblock bg-zinc-950",children:[!v&&(0,s.jsxs)("div",{className:"flex items-center justify-between w-full px-6 py-2 pr-4 bg-zinc-800 text-zinc-100",children:[(0,s.jsx)("span",{className:"text-xs lowercase",children:t}),(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[!window.location.href.includes("vscode=")&&(0,s.jsxs)(c.z,{variant:"ghost",className:!1==window.matchMedia("(max-width: 768px)").matches?"hover:bg-zinc-800 focus-visible:ring-1 focus-visible:ring-slate-700 focus-visible:ring-offset-0 pr-10":"hover:bg-zinc-800 focus-visible:ring-1 focus-visible:ring-slate-700 focus-visible:ring-offset-0 pr-2",onClick:()=>{(0,g.X)("Other Engagement",E,{tag:"codefullscreen"}),window.open("/editor?id=".concat((0,x.x0)(),"&lang=").concat(t,"&code=").concat(encodeURIComponent(k)))},size:"icon",children:[(0,s.jsx)("span",{className:"hidden sm:block text-xs",children:"Open In Editor"}),(0,s.jsx)("span",{className:"sm:hidden text-xs",children:"Editor"})]}),w?(0,s.jsxs)(c.z,{variant:"ghost",className:"hover:bg-zinc-800 focus-visible:ring-1 focus-visible:ring-slate-700 focus-visible:ring-offset-0",onClick:saveEdit,size:"icon",children:[(0,s.jsx)(r.NO,{}),(0,s.jsx)("span",{className:"sr-only",children:"Save"})]}):(0,s.jsxs)(c.z,{variant:"ghost",className:"hover:bg-zinc-800 focus-visible:ring-1 focus-visible:ring-slate-700 focus-visible:ring-offset-0",onClick:edit,size:"icon",children:[(0,s.jsx)(r.yl,{}),(0,s.jsx)("span",{className:"sr-only",children:"Edit"})]}),!window.location.href.includes("vscode=")&&R.includes(t.toLocaleLowerCase())&&(0,s.jsxs)(c.z,{variant:"ghost",className:"hover:bg-zinc-800 focus-visible:ring-1 focus-visible:ring-slate-700 focus-visible:ring-offset-0",onClick:e=>handlePlayClick(null==e?void 0:e.target),size:"icon",children:[F?(0,s.jsx)(r.c0,{}):(0,s.jsx)(u.o1U,{}),(0,s.jsx)("span",{className:"sr-only",children:"Run"})]}),(0,s.jsxs)(c.z,{variant:"ghost",size:"icon",className:"text-xs hover:bg-zinc-800 focus-visible:ring-1 focus-visible:ring-slate-700 focus-visible:ring-offset-0",onClick:()=>{j||y(a)},children:[j?(0,s.jsx)(r.NO,{}):(0,s.jsx)(r.vU,{}),(0,s.jsx)("span",{className:"sr-only",children:"Copy code"})]})]})]}),w?(0,s.jsx)(d.g,{value:k,ref:S,style:{fontFamily:"monospace",border:"0"},rows:k.includes("\n")?k.split("\n").length:k.length>80?Math.round(k.length/80):1,onBlur:saveEdit,onChange:changeEdit,onKeyDown:e=>{if("Tab"==e.key){e.preventDefault();let{selectionStart:a,selectionEnd:s}=e.target,n=k.substring(0,a)+"    "+k.substring(s,k.length);if(S.current){var t;S.current.focus(),S.current.value=n,null===(t=S.current)||void 0===t||t.setSelectionRange(a+4,a+4),C(n)}}}}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.Z,{language:t,style:l.RY,PreTag:"div",showLineNumbers:!0,customStyle:{margin:0,width:"100%",background:"transparent",padding:"1.5rem 1rem"},codeTagProps:{style:{fontSize:"0.9rem",fontFamily:"var(--font-mono)"}},children:k}),z&&(0,s.jsx)("div",{style:{padding:"1em 2em"},className:"w-full bg-white text-black",dangerouslySetInnerHTML:{__html:z}})]})]})});v.displayName="CodeBlock"},38776:function(e,t,a){a.r(t),a.d(t,{Separator:function(){return i}});var s=a(95802),n=a(82038),o=a(51863),l=a(81936);let i=n.forwardRef((e,t)=>{let{className:a,orientation:n="horizontal",decorative:i=!0,...r}=e;return(0,s.jsx)(o.f,{ref:t,decorative:i,orientation:n,className:(0,l.cn)("shrink-0 bg-border","horizontal"===n?"h-[1px] w-full":"h-full w-[1px]",a),...r})});i.displayName=o.f.displayName},95849:function(e,t,a){a.d(t,{Ei:function(){return h},Tu:function(){return SheetHeader},bC:function(){return m},ue:function(){return p},yo:function(){return c}});var s=a(95802),n=a(82038),o=a(67371),l=a(73918),i=a(80845),r=a(81936);let c=o.fC;o.xz,o.x8;let d=o.h_,g=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(o.aV,{className:(0,r.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...n,ref:t})});g.displayName=o.aV.displayName;let u=(0,l.j)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),p=n.forwardRef((e,t)=>{let{side:a="right",className:n,children:l,...c}=e;return(0,s.jsxs)(d,{children:[(0,s.jsx)(g,{}),(0,s.jsxs)(o.VY,{ref:t,className:(0,r.cn)(u({side:a}),n),...c,children:[l,(0,s.jsxs)(o.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,s.jsx)(i.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});p.displayName=o.VY.displayName;let SheetHeader=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,r.cn)("flex flex-col space-y-2 text-left sm:text-left",t),...a})};SheetHeader.displayName="SheetHeader";let m=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(o.Dx,{ref:t,className:(0,r.cn)("text-lg font-semibold text-foreground",a),...n})});m.displayName=o.Dx.displayName;let h=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(o.dk,{ref:t,className:(0,r.cn)("text-sm",a),...n})});h.displayName=o.dk.displayName},63069:function(e,t,a){a.d(t,{y:function(){return getAgent}});let s={};async function getAgent(e){try{let t={};if(s[e])t=s[e];else{let a=await fetch("/api/getagent",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})});t=await a.json(),s[e]=t}return{name:t.name,cover:t.cover,id:t.id,sysprompt:t.sysprompt,createdAt:t.createdAt}}catch(e){return console.log("getAgent: ",e),{}}}},96163:function(e,t,a){a.d(t,{H:function(){return getTrendingAgentImage}});function getTrendingAgentImage(e){return({codecomment:"https://storage.googleapis.com/a1aa/uploads/codecomment.png",improvecode:"https://storage.googleapis.com/a1aa/uploads/codeimprover.png",explaincode:"https://storage.googleapis.com/a1aa/uploads/codeexplainer.png",mongodb:"https://storage.googleapis.com/a1aa/uploads/mongodb-original.png",python:"https://storage.googleapis.com/a1aa/uploads/python-original.png",html:"https://storage.googleapis.com/a1aa/uploads/html5-original.png",swift:"https://storage.googleapis.com/a1aa/uploads/swift-original.png",javascript:"https://storage.googleapis.com/a1aa/uploads/javascript-original.png",react:"https://storage.googleapis.com/a1aa/uploads/react-original.png",xcode:"https://storage.googleapis.com/a1aa/uploads/xcode-plain.png",pytorch:"https://storage.googleapis.com/a1aa/uploads/pytorch-original.png","next.js":"https://storage.googleapis.com/a1aa/uploads/nextjs-original.png",android:"https://storage.googleapis.com/a1aa/uploads/android-original.png",angularjs:"https://storage.googleapis.com/a1aa/uploads/angularjs-original.png",azure:"https://storage.googleapis.com/a1aa/uploads/azure-original.png",bitbucket:"https://storage.googleapis.com/a1aa/uploads/bitbucket-original.png",digitalocean:"https://storage.googleapis.com/a1aa/uploads/digitalocean-original.png",docker:"https://storage.googleapis.com/a1aa/uploads/docker-plain.png",electron:"https://storage.googleapis.com/a1aa/uploads/electron-original.png",erlang:"https://storage.googleapis.com/a1aa/uploads/erlang-plain.png",fastapi:"https://storage.googleapis.com/a1aa/uploads/fastapi-plain.png",firebase:"https://storage.googleapis.com/a1aa/uploads/firebase-plain.png",flask:"https://storage.googleapis.com/a1aa/uploads/flask-original.png",flutter:"https://storage.googleapis.com/a1aa/uploads/flutter-plain.png",git:"https://storage.googleapis.com/a1aa/uploads/git-plain.png",github:"https://storage.googleapis.com/a1aa/uploads/github-original-logo.png",gitlab:"https://storage.googleapis.com/a1aa/uploads/gitlab-plain.png",go:"https://storage.googleapis.com/a1aa/uploads/go-plain.png",godot:"https://storage.googleapis.com/a1aa/uploads/godot-original.png",googlecloud:"https://storage.googleapis.com/a1aa/uploads/googlecloud-original.png",heroku:"https://storage.googleapis.com/a1aa/uploads/heroku-plain.png",java:"https://storage.googleapis.com/a1aa/uploads/java-plain.png",youtube:"https://storage.googleapis.com/a1aa/uploads/youtube-original.png",steve:"https://storage.googleapis.com/a1aa/uploads/steve-apple.png",elon:"https://storage.googleapis.com/a1aa/uploads/elonmusk.png","front-end-builder":"/_next/image?url=%2F_next%2Fstatic%2Fmedia%2Fillustrator-plain.5aa02bf8.png&w=128&q=100",pdf:"/_next/image?url=%2F_next%2Fstatic%2Fmedia%2Fpdf.23bc4a25.png&w=128&q=100",video:"/_next/image?url=%2F_next%2Fstatic%2Fmedia%2Fvideo.626fa2a2.png&w=128&q=100"})[e.toLocaleLowerCase()]||null}},60110:function(e,t,a){a.d(t,{m:function(){return useCopyToClipboard}});var s=a(82038);function useCopyToClipboard(e){let{timeout:t=2e3}=e,[a,n]=s.useState(!1);return{isCopied:a,copyToClipboard:e=>{var a;if((null===(a=navigator.clipboard)||void 0===a?void 0:a.writeText)&&e){if(window.location.href.includes("vscode=")){var s=document.createElement("textarea");document.body.appendChild(s),s.value=e,s.select(),document.execCommand("copy"),document.body.removeChild(s),n(!0),setTimeout(()=>{n(!1)},t)}else navigator.clipboard.writeText(e).then(()=>{n(!0),setTimeout(()=>{n(!1)},t)})}}}}}}]);